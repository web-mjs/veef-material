const e=n=>{if(n.charAt)return document.createTextNode(n);let r=document.createElement(n.name||"div");return n.props.map((e=>r[e.name]=e.value)),r.append(...n.children.map((n=>e(n)))),r},n=(r,a,p,t,l)=>{if(void 0!==r){if(a.charAt&&r.charAt)return r!==a?void p.insertBefore(document.createTextNode(a),p.childNodes[t]):void 0;if(r.name!=a.name)return l.push({name:r.name,dom:p.childNodes[t]}),void p.replaceChild(e(a),p.childNodes[t]);a.props.filter((e=>e.value!=a.props[e.key])).map((e=>p[e.key]=e.value)),l=[],a.children.map(((e,a)=>n(r.children[a],e,p,a,l)))}else{if(a.name){let e=null;for(;e=l.shift();)if(e.name==a.name)return void p.appendChild(e.dom)}p.appendChild(e(a))}},r=(e,r,a)=>n(e,r,a,0,[]),a=(e,...n)=>{const r=e=>({name:e,props:[],children:[""],x:0});let a=r(""),p=a,t=[a],l=null,i=2,o=e=>a.children.push(e),d=e=>{a.x=o(e),o("")},f=e=>a.props[0].value+=l,s={0:{">":2," ":1,"/":4,fn:()=>{a.name+=l}},1:{">":2," ":1,"/":4,fn:()=>{a.props.unshift({name:l,value:""}),i=6}},6:{"=":7,fn:()=>{a.props[0].name+=l}},7:{'"':8,"'":9,fn:f},8:{'"':1,fn:f},9:{"'":1,fn:f},2:{"<":3,fn:()=>{a.children[a.x]+=l}},3:{"/":4,fn:()=>{const e=r(l);t.push(a),d(e),a=e,i=0}},4:{fn:()=>{">"==l&&(a=t.pop(),i=2)}}},c=0;for(var h=0;;h++){if(h>=e[c].length){const r=n[c];if(!r)break;if(6!=i&&7!=i||(a.props[0].value=r,i=1),2==i&&d(r),h=0,c++,c>=e.length||h>=e[c].length)break}l=e[c][h];let r=s[i];l in r?i=r[l]:r.fn()}return p};export{r as diff,a as parse,e as render};
